/**
 * Copyright (c) 2013 ColtJS
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy 
 * of this software and associated documentation files (the "Software"), to deal 
 * in the Software without restriction, including without limitation the rights 
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies 
 * of the Software, and to permit persons to whom the Software is furnished to do 
 * so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in all 
 * copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, 
 * INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A 
 * PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT 
 * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION 
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE 
 * SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */
define(function(){var e={routes:{},scope:{},init:function(){var e=this,t;require(e.modules,function(){for(var n=0,r=arguments.length;n<r;n++){t=e.modules[n].split("/").pop();e.scope[t]=arguments[n];e.scope[t].mid=t;e.scope[t].el=document.getElementById(t);if(typeof jQuery!=="undefined"){e.scope[t].$el=jQuery("#"+t)}}e.router()})},router:function(){var e=this,t=window.location.hash,n=null;for(var r in e.scope){for(var i in e.scope[r].routes){e.routes[i]=[r,e.scope[r].routes[i]]}}e.loadUrl(t);window.onhashchange=function(){e.loadUrl(window.location.hash)}},loadUrl:function(e){var t=this,n,r,i={};e=e.replace("#!/","");e=e.split("?");if(e[1]){var s=e[1].split("&");for(var o=0;o<s.length;o++){var u=s[o].split("=");i[u[0]]=u[1]}}for(var a in t.routes){if(t.routes.hasOwnProperty(a)){r=t.routes[a][0];if(e[0]===a||a==="*"){if(n!==r){n=r;t.processor(r,t.routes[a][1],i)}}else{document.getElementById(r).innerHTML=""}}}},processor:function(e,t,n){function s(e,t,r){var i=[],s=[];if(t.hasOwnProperty("dependencies")){for(var o in t.dependencies){i.push(o);s.push(t.dependencies[o])}require(s,function(){for(var s=0,o=arguments.length;s<o;s++){t[i[s]]=arguments[s]}t[r](e,t,n)})}else{t[r](e,t,n)}}var r=this,i=r.scope[e];if(!i.hasOwnProperty("template")){r.AJAX("templates/"+i.mid+".tpl",function(e){if(e){i.template=e;s(r,i,t)}else{console.error("Error Loading "+i.mid+".tpl")}})}else{s(r,i,t)}},render:function(e,t){var n=e.template,r=n.replace(/\{\{([^}]+)\}\}/g,function(e,n){return t[n]});document.getElementById(e.mid).innerHTML=r;this.delegateEvents(e.events,e)},navigate:function(e){var t=window.location;var n=t.pathname.replace(/[^\/]$/,"$&");t.replace(n+t.search+"#!/"+e)},delegateEvents:function(e,t){var n=this,r,i,s,o,u;if(!t.hasOwnProperty("events_bound")){if(!e){return}var a=/^(\S+)\s*(.*)$/;for(key in e){if(e.hasOwnProperty(key)){r=e[key];i=key.match(a);s=i[1];o=i[2];u=document.querySelectorAll("#"+t.mid+" "+o);(function(e,r){for(var i=0,o=e.length;i<o;i++){if(e[i].addEventListener){e[i].addEventListener(s,function(e){e.preventDefault?e.preventDefault():e.returnValue=false;t[r](e,n,t)},false)}else{e[i].attachEvent("on"+s,function(e){e.preventDefault?e.preventDefault():e.returnValue=false;t[r](e,n,t)})}}})(u,r)}}}},AJAX:function(e,t,n,r,i){var s=false;e=e||"";n=n||"GET";r=r||true;i=i||null;if(window.XMLHttpRequest){s=new XMLHttpRequest}else if(window.ActiveXObject){s=new ActiveXObject("Microsoft.XMLHTTP")}if(s!==false){if(n=="GET"){e=e;i=null}s.open(n,e,r);if(n==="POST"){s.setRequestHeader("Content-Type","application/x-www-form-urlencoded")}s.onreadystatechange=function(){if(s.readyState===4){if(typeof t==="function"){t(s.responseText)}}};s.send(i)}else{alert("Please use a browser with AJAX support!")}}};return e})