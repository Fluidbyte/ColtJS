/**
 * Copyright (c) 2013 ColtJS
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy 
 * of this software and associated documentation files (the "Software"), to deal 
 * in the Software without restriction, including without limitation the rights 
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies 
 * of the Software, and to permit persons to whom the Software is furnished to do 
 * so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in all 
 * copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, 
 * INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A 
 * PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT 
 * HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION 
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE 
 * SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 */
define(function(){var e={routes:{},scope:{},init:function(){var t;window.Colt=e;require(e.modules,function(){for(var n=0,r=arguments.length;n<r;n++){t=e.modules[n].split("/").pop();e.scope[t]=arguments[n];e.scope[t].mid=t;e.scope[t].el=document.getElementById(t);if(typeof jQuery!=="undefined"){e.scope[t].$el=jQuery("#"+t)}}e.router()})},router:function(){var t=window.location.hash,n=null;for(var r in e.scope){for(var i in e.scope[r].routes){e.routes[i]=[r,e.scope[r].routes[i]]}}e.loadUrl(t);window.onhashchange=function(){e.loadUrl(window.location.hash)}},loadUrl:function(t){var n,r,i={};t=t.replace("#!/","");t=t.split("?");if(t[1]){var s=t[1].split("&");for(var o=0;o<s.length;o++){var u=s[o].split("=");i[u[0]]=u[1]}}for(var a in e.routes){if(e.routes.hasOwnProperty(a)){r=e.routes[a][0];if(t[0]===a||a==="*"){if(n!==r){n=r;e.processor(r,e.routes[a][1],i)}}else{document.getElementById(r).innerHTML=""}}}},processor:function(t,n,r){function s(e,t,n){var i=[],s=[];if(t.hasOwnProperty("dependencies")){for(var o in t.dependencies){i.push(o);s.push(t.dependencies[o])}require(s,function(){for(var e=0,s=arguments.length;e<s;e++){t[i[e]]=arguments[e]}t[n](r)})}else{t[n](r)}}var i=e.scope[t];if(!i.hasOwnProperty("template")){e.AJAX("templates/"+i.mid+".tpl",function(t){if(t){i.template=t;s(e,i,n)}else{console.error("Error Loading "+i.mid+".tpl")}})}else{s(e,i,n)}},render:function(e,t){var n=e.template,r=n.replace(/\{\{([^}]+)\}\}/g,function(e,n){return t[n]});document.getElementById(e.mid).innerHTML=r;this.delegateEvents(e.events,e)},navigate:function(e){var t=window.location,n=t.pathname.replace(/[^\/]$/,"$&");t.replace(n+t.search+"#!/"+e)},delegateEvents:function(e,t){var n,r,i,s,o;if(!t.hasOwnProperty("events_bound")){if(!e){return}var u=/^(\S+)\s*(.*)$/;for(key in e){if(e.hasOwnProperty(key)){n=e[key];r=key.match(u);i=r[1];s=r[2];o=document.querySelectorAll("#"+t.mid+" "+s);(function(e,n){for(var r=0,s=e.length;r<s;r++){if(e[r].addEventListener){e[r].addEventListener(i,function(e){e.preventDefault?e.preventDefault():e.returnValue=false;t[n](e)},false)}else{e[r].attachEvent("on"+i,function(e){e.preventDefault?e.preventDefault():e.returnValue=false;t[n](e)})}}})(o,n)}}}},AJAX:function(e,t,n,r,i){var s=false;e=e||"";n=n||"GET";r=r||true;i=i||null;if(window.XMLHttpRequest){s=new XMLHttpRequest}else if(window.ActiveXObject){s=new ActiveXObject("Microsoft.XMLHTTP")}if(s!==false){if(n=="GET"){e=e;i=null}s.open(n,e,r);if(n==="POST"){s.setRequestHeader("Content-Type","application/x-www-form-urlencoded")}s.onreadystatechange=function(){if(s.readyState===4){if(typeof t==="function"){t(s.responseText)}}};s.send(i)}else{alert("Please use a browser with AJAX support!")}}};return e})